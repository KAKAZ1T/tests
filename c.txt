local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")

function MakeDraggable(BarObject, Object)
    local Dragging = false
    local DragInput = nil
    local DragStart = nil
    local StartPosition = nil

    function Update(input)
        local Delta = input.Position - DragStart
        local pos =
            UDim2.new(
                StartPosition.X.Scale,
                StartPosition.X.Offset + Delta.X,
                StartPosition.Y.Scale,
                StartPosition.Y.Offset + Delta.Y
            )
        local Tween = TweenService:Create(Object, TweenInfo.new(0.2), {Position = pos})
        Tween:Play()
    end

    BarObject.InputBegan:Connect(
        function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                Dragging = true
                DragStart = input.Position
                StartPosition = Object.Position

                input.Changed:Connect(
                    function()
                        if input.UserInputState == Enum.UserInputState.End then
                            Dragging = false
                        end
                    end
                )
            end
        end
    )

    BarObject.InputChanged:Connect(
        function(input)
            if
                input.UserInputType == Enum.UserInputType.MouseMovement or
                input.UserInputType == Enum.UserInputType.Touch
            then
                DragInput = input
            end
        end
    )

    UIS.InputChanged:Connect(
        function(input)
            if input == DragInput and Dragging then
                Update(input)
            end
        end
    )
end

-- Exemplo de uso:
local bar = Instance.new("TextButton")
bar.Text = "Drag Me"
bar.Size = UDim2.new(0, 200, 0, 50)
bar.Position = UDim2.new(0.5, -100, 0.5, -25)
bar.Parent = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")

local object = Instance.new("Frame")
object.Size = UDim2.new(0, 100, 0, 100)
object.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
object.Position = UDim2.new(0.5, -50, 0.4, -50)
object.Parent = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")

MakeDraggable(bar, object)
